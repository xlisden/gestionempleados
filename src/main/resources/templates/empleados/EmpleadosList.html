<!DOCTYPE html>
<html lang="es">

<head th:replace="~{shared/head :: head() }"></head>
<div th:replace="~{shared/header/header :: header() }"></div>
<style>
    a {
        text-decoration: none;
    }
    .toast {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 1050;
    }
    .toast .d-flex img {
        vertical-align: middle;
    }
</style>
<body>

<div class="container px-5">
    <h1 class="pb-3">Empleados</h1>

    <div class="d-flex justify-content-between align-items-center pb-3">
        <a href="/empleados/agregar" class="btn btn-primary col-sm-2" style="font-size: 1.10rem">
            <i class="bi bi-plus-circle"></i> Agregar Empleado
        </a>

        <form th:action="@{/empleados}" class="d-flex flex-grow-1 align-items-center" method="GET">
            <div class="col-sm-3 ms-auto" style="margin-right: 8px">
                <div class="form-floating">
                    <input type="text" class="form-control" id="floatBuscar" placeholder="buscar" th:value="${nombre}" name="nombre">
                    <label for="floatBuscar">Buscar por DNI, código o nombre...</label>
                </div>
            </div>

            <div id="selectArea" class="col-sm-2">
                <div class="form-floating">
                    <select id="floatArea" name="areaa" class="form-select">
                        <option value="">Seleccione...</option>
                        <option th:each="area : ${ areas }" th:value="${ area.id }" th:text="${ area.nombre }" th:selected="${ area.id == areaa }"></option>
                    </select>
                    <label for="floatArea">Buscar por Área</label>
                </div>
            </div>

            <div id="selectJornada" class="col-sm-2 " style="margin-left: 8px">
                <div class="form-floating">
                    <select id="floatJornada" name="jornad" class="form-select">
                        <option value="">Seleccione...</option>
                        <option th:each="jornada : ${ jornadas }" th:value="${ jornada.id }" th:text="${ jornada.nombre }" th:selected="${ jornada.id == jornad }" ></option>
                    </select>
                    <label for="floatJornada">Buscar por Jornada</label>
                </div>
            </div>

            <button type="submit" class="btn btn-outline-primary col-sm-2" style="font-size: 1.25rem; margin-left: 15px">Buscar</button>
        </form>
    </div>

    <div class="table-responsive">
        <table class="table align-middle">
            <thead class="table">
            <tr>
                <th>Cod.</th>
                <th>Nombre Completo</th>
                <th>Area</th>
                <th>Antiguedad</th>
                <th>Modalidad Cont.</th>
                <th>Jornada Lab.</th>
                <th></th>
                <th>Operaciones</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="empleado : ${ empleados }" th:object="${empleado}">
                <td th:text="${ empleado.cod }"></td>
                <td th:text="${ empleado.nombreCompleto }"></td>
                <td th:text="${ empleado.area }"></td>
                <td th:text="${ empleado.antiguedad }"></td>
                <td th:text="${ empleado.modalidadContrato }"></td>
                <td th:text="${ empleado.jornadaLaboral  }"></td>
                <td>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" role="switch" id="isActivo" th:checked="${empleado.activo}"
                               th:onclick="'javascript:window.location.href=\'' + (${empleado.activo} ? @{/empleados/desactivar/{id}(id=${empleado.id})} : @{/empleados/activar/{id}(id=${empleado.id})}) + '\''">

                    </div>
                </td>
                <td>
                    <a th:href="@{/empleados/{id}(id=${ empleado.id })}">
                        <img th:src="@{/img/detalle.png}" width="30" height="30" alt="detalleIcon">
                    </a>
                    <a th:href="@{/empleados/editar/{id}(id=${ empleado.id })}" style="font-size: 1.5rem">
                        <img src="/icons/edit.svg" alt="editsvg" width="30" height="30">
                    </a>
                    <a th:href="@{/empleados/emitir-recibo/{id}(id=${ empleado.id })}">
                        <img src="/icons/pay.svg" alt="editsvg" width="30" height="30">
                    </a>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>


<div class="toast align-items-center" role="alert" aria-live="assertive" aria-atomic="true" id="liveToast"
     th:if="${mensaje != null}">
    <div class="d-flex align-items-center">
        <img src="/icons/success.svg" class="rounded ms-2" alt="Éxito" width="20" height="20">
        <div class="toast-body" th:text="${mensaje}"></div>
        <button type="button" class="btn-close me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
    </div>
</div>
<div class="toast align-items-center" role="alert" aria-live="assertive" aria-atomic="true" id="errorToast"
     th:if="${error != null}">
    <div class="d-flex">
        <img src="/icons/error.svg" class="rounded ms-2" alt="Éxito" width="20" height="20">
        <div class="toast-body">
            <span th:text="${error}"></span>
        </div>
        <button type="button" class="btn-close me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script th:inline="javascript">
    /*<![CDATA[*/
    document.addEventListener('DOMContentLoaded', function () {
        var toastElement = document.getElementById('liveToast');
        var errorToastElement = document.getElementById('errorToast');

        if (toastElement) {
            var toast = new bootstrap.Toast(toastElement);
            toast.show();
        }

        if (errorToastElement) {
            var errorToast = new bootstrap.Toast(errorToastElement);
            errorToast.show();
        }
    });
    /*]]>*/
</script>

</body>
</html>